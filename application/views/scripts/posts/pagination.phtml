<?php 
    $this->declareVars(array(
        'js' => false,
        'attributes' => array(),
        'cssClass' => '',
    ));
?>
<div class="pagination <?php echo $this->cssClass?>" <?php HtmlHelper::hidden($this->model->getTotalPages()<=1);?>
    <?php if($this->js): wp_enqueue_script('backbone-brx-pagination');?>
        backbone-view="brx.Pagination"
        currentPage="<?php echo $this->model->getCurrentPage()?>"
        totalPages="<?php echo $this->model->getTotalPages()?>"
        hrefTemplate="<?php echo str_replace('.page.', '<%= page %>', $this->model->getPageLinkPattern());?>"
        <?php if(is_string($this->js)):?>
        populate="<?php echo $this->js;?>"
        <?php endif;?>
    <?php endif?> 
    <?php foreach($this->attributes as $key=>$value){
        printf('%s="%s" ', $key, $this->escape($value));
    }?>>
    <ul>
<?php 
    $links = array();
    $links[] = array('text'=>'&larr;', 'link' => $this->model->getPreviousPageLink()?$this->model->getPreviousPageLink():'#');
    if($this->model->getPackFirstPage() > 1){
        $links[] = array('text'=>'1', 'link' => $this->model->getPageLink(1));
    }
    if($this->model->getPackFirstPage() > 2){
        $links[] = array('text'=>'...', 'link' => $this->model->getPreviousPackLink());
    }
    for($i = $this->model->getPackFirstPage(); $i <= $this->model->getPackLastPage(); $i++){
        $links[] = array('text'=>$i, 'link' => $this->model->getPageLink($i));
    }
    if($this->model->getPackLastPage() < $this->model->getTotalPages() - 2){
        $links[] = array('text'=>'...', 'link' => $this->model->getNextPackLink());
    }
    if($this->model->getPackLastPage() < $this->model->getTotalPages()){
        $links[] = array('text'=>$this->model->getTotalPages(), 'link' => $this->model->getPageLink($this->model->getTotalPages()));
    }
    $links[] = array('text'=>'&rarr;', 'link' => $this->model->getNextPageLink()?$this->model->getNextPageLink():'#');

    foreach($links as $link){
        if($link['link']){
            $classes = $link['text'] == $this->model->getCurrentPage()? 'active ':'';
            $classes.= $link['link'] == '#'? 'disabled ':''
            ?>
        <li class="<?php echo $classes;?>"><a href="<?php echo $link['link'];?>"><?php echo $link['text'];?></a></li>
            <?php
        }
    }
?>    
    </ul>
</div>